---
title: 解决Input约束输入值为非负整数中遇到的一揽子问题
date: 2021-05-11 17:28:54
---

### 问题描述：

​		项目中要求实现某模块的人数/天数输入值不能为负值

### 解决思路：

​		1.无法键入0-9以外的字符

​		2.键入0-9以外的字符错误提示并无法提交

<!--more-->

### 解决过程：

​		第一次尝试：

​				Input type类型改为number ,min为0。

​				写完心满意足提交了代码，结果同事测试说上下键是没法子按到负值了，但是输入还是可以键入负数的。。。。。好吧

​		第二次尝试

​				用正则把输入的符号给替换掉。

​                结果同事提出意见说，Input里面用defaultValue做值的显示也就是当前的Input是一个非受控组件，用正则无法替换（既然这样，那为什么不用value呢，这里引申出另一个问题，defaultValue与value的使用场景，下一章里面详细谈论这个问题）

​		第三次尝试

​				改用AvField组件，在输入0-9以外的字符给出错误提示

​				改完在测试过程中发现，输入负号弹出来的报错信息不是预定的errorMessage，是this field is invaild。。。啊这什么鬼，后来在尝试过程中发现如果把type改为text就会正常输出预定的errorMessage。。。猜测可能是number限制的范围是所有整数（包括负号）。。。而AvField的validate中验证是非负整数，两个验证冲突？？？（或许是）

​		第四次尝试

​				在第三次的基础上加入onKeyDown，输入非预期的字符则调用e.preventDefault()，嗯，这下子不能输入负号了。。。。。最后测试，发现这样不能避免Ctrl C/V，还有浏览器剪切板粘贴。。。后期考虑再改为onMouseDown了.